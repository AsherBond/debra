prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=@bindir@
datarootdir=@datarootdir@
mandir=@mandir@
INSTALL=@INSTALL@

all:
	@true

install:
	$(INSTALL) -d $(DESTDIR)$(bindir)
	$(INSTALL) bin/debra $(DESTDIR)$(bindir)/
	$(INSTALL) bin/sourceinstall $(DESTDIR)$(bindir)/
	$(INSTALL) -d $(DESTDIR)$(mandir)/man8
	$(INSTALL) man/man8/debra.8.gz $(DESTDIR)$(mandir)/man8/
	$(INSTALL) man/man8/sourceinstall.8.gz $(DESTDIR)$(mandir)/man8/
 
uninstall:
	rm -f $(DESTDIR)$(bindir)/debra $(DESTDIR)$(bindir)/sourceinstall
	rm -f $(DESTDIR)$(mandir)/man8/debra.8.gz \
		$(DESTDIR)$(mandir)/man8/sourceinstall.8.gz
	rmdir --ignore-fail-on-non-empty $(DESTDIR)$(mandir)/man8

man:
	@make -C man all

deb:
	git archive --prefix=debra-0.1.3/ v0.1.3 | gzip >/var/www/static/debra-0.1.3.tar.gz
	bin/debra create debian control
	bin/debra sourceinstall debian http://static.rmilitia.com/debra-0.1.3.tar.gz -p /usr/local
	bin/debra build debian debra_0.1.3-1_all.deb
	bin/debra destroy debian

.PHONY: all install uninstall man deb
